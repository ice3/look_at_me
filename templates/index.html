<!DOCTYPE HTML>
<html>
<head>
	<title>Test</title>
	<!-- // <script type="text/javascript" src="{{url_for('static', filename='js/sock-io.js')}}"></script> -->
	 <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/0.9.16/socket.io.min.js"></script>
	<script type="text/javascript" src="/static/js/jquery-2.1.3.min.js"></script>
	<script type="text/javascript" src="/static/js/highcharts.js"></script>
	<script type="text/javascript" src="/static/js/highcharts-exporting.js"></script>


	<script type="text/javascript" charset="utf-8">
		var socket
		$(document).ready(function(){
			namespace = '/test'; 
			socket = io.connect('http://' + document.domain + ':' + location.port + namespace);
			socket.on('connect', function() {
			socket.emit('my event', {data: 'I\'m connected!'});
			});
		});

		$(function () {
			Highcharts.setOptions({

			});

			$('#container').highcharts({
				title: {
					text: "Monthly average temperature",
					x: -20 //center
				},
				subtitle: {
					text: "Source: WorldClimate.com",
					x: -20
				}, 
				xAxis: {
					categories: ["Jan", "Feb", "Mars", "Apr", "May", "Jun", "July", "Aug", "Sep", "Oct", "Nov", "Dec"]
				}, 
				yAxis: {
					title: {
						text:'Temperature (°C)', 
					},
					plotLines: [{
						value: 0, 
						wodth: 1, 
						color: '#808080'
					}]
				},
				tooltip: {
					valueSuffix: '°C'
				},
				plotOptions: {
					chart: {
						animation: false
					},
					series: {
						marker: {
							enabled: false
						},
						animation: false
					}
				},

				legend: {
					layout: 'vertical', 
					align: 'center',
					borderWidth: 0
				},
				series: [
					{
						name: 'Tokyo', 
						data: [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0, 0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]

					}
					// {
					// 	name: 'New York',
     //        			data: [-0.2, 0.8, 5.7, 11.3, 17.0, 22.0, 24.8, 24.1, 20.1, 14.1, 8.6, 2.5]
					// },
					// {

			  //           name: 'Berlin',
     //        			data: [-0.9, 0.6, 3.5, 8.4, 13.5, 17.0, 18.6, 17.9, 14.3, 9.0, 3.9, 1.0]
     //    			}
				]
			})	
			var chart = $('#container').highcharts(),
				i = Math.random() * 50 ;
				redraw = false;

			$('#button').click(function () {
				i = i + (Math.random() * 10 - 5);
				chart.series[0].addPoint( i, false, true, false);
				redraw = true;
			});

			socket.on("graph", function(msg){
				console.log(msg);
				chart.series[0].addPoint(msg["data"], true, true, true);
				redraw = true;
			});

			// setInterval( function() 
			// 	{
			// 		if(redraw === true){
			// 			chart.redraw();
			// 			redraw = false;
			// 			console.log("redraw");
			// 		}
			// 	},
			// 	20);
		});

	</script>
</head>

<body>
	<h1>
		Coucou
	</h1>

	<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
	<button id="button" class="autocompare">Update first point</button>
</body>